# PowerAI ノートブックで画像認識モデルをトレーニングする

### Jupyter Notebook で、転移学習を使用して独自の画像分類子を作成する

English version: https://developer.ibm.com/patterns/image-recognition-training-powerai-notebooks
  ソースコード: https://github.com/IBM/powerai-transfer-learning?cm_sp=IBMCode-_-image-recognition-training-powerai-notebooks-_-Get-the-Code

###### 最新の英語版コンテンツは上記URLを参照してください。
last_updated: 2017-03-15

 
## 概要

このコード・パターンは、PowerAI という IBM の新しいオファリングを利用したいと思っている開発者向けに作成されています。Jupyter Notebook を使用して、IBM POWER8&reg; システム上で TensorFlow Inception モデルを使って転移学習を行う例を紹介します。このノートブックは、例として JPEG 画像からプール付きの家とプール付きでない家を認識するカスタム分類子を作成する方法に重点を置いています。このコード・パターンの対象読者は、十分な時間も、データ・サイエンスの経験もない中で、強力な深層学習アプリケーションを効率的に構築する必要に迫られている開発者です。

## 説明

転移学習とは、事前にトレーニングされたモデル (他の誰かが大規模なデータ・セットを基にトレーニングした、ネットワークの重みとパラメーター) を、独自のデータ・セットを使用して微調整するというプロセスです。その狙いは、事前にトレーニングされたモデルを特徴抽出器として機能させることにあります。転移学習では、ニューラル・ネットワークの最終層を削除して、(目的の問題領域に応じた) 独自の分類子で置き換えます。他のすべての層に対する重みは凍結して (つまり、勾配降下/最適化を行う際に重みを変えないということ)、通常どおりにネットワークをトレーニングします。画像分類の実験には、事前にトレーニングされた Inception-v3 モデルを使用しました。このモデルは以下の 2 つの部分からなります。

* 畳み込みニューラル・ネットワークによる特徴抽出
* 全結合ソフトマックス層による分類

事前にトレーニングされた Inception-v3 モデルは、一般的なオブジェクトを最新鋭の精度で認識して、それらのオブジェクトを 1,000 クラスに分類することができます。このモデルは、最初の部分で入力画像から一般的な特徴を抽出し、2 番目の部分でそれらの特徴に基づいて画像を分類します。この事前にトレーニングされたモデルを、プール付きの家とプール付きでない家を分類するように再トレーニングします。

このコード・パターンを完了すると、Jupyter Notebook に Nimbix と PowerAI をロードして実行する方法、転移学習で TensorFlow Inception モデルを利用して一連の画像からカスタム分類子を作成する方法、作成した分類子をテストして実証する方法がわかるようになります。

## フロー

![フロー](../../images/image-recognition-arch.png)

1. 開発者が、用意されているノートブックをロードし、このノートブックを PowerAI システム上で実行します。
2. 用意されているサンプル・データ・セットは、プール付きの家の画像とプール付きではない家の画像を認識するという使用ケースを説明するためのものです。
3. ノートブックでは、TensorFlow Inception モデルと再トレーニング用のサンプル・データ・セットを使用し、この既存のモデルを活用してカスタム分類子を作成します。
4. ノートブックでは、元のモデルを使用した結果と新しいモデルを使用した結果を比較します。

## 手順

このパターンの詳細な手順については、[README](https://github.com/IBM/powerai-transfer-learning/blob/master/README.md) を参照してください。手順の概要は以下のとおりです。

1. 24時間無料でアクセスできる PowerAI プラットフォームのトライアルに登録します。
2. Jupyter Notebook にアクセスして起動します。
3. ノートブックを実行します。
4. 結果を分析します。
5. 結果を保存して共有します。
6. トライアルを終了します。
